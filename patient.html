<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link type="text/css" rel="stylesheet" href="/css/patient.css" />
    <title>Patient Info</title>
  </head>
  <body>
    <div class="container-fluid">
      <div id="header" class="row d-flex">
        <img
          style="position: absolute; height: 15%; width: 15%"
          src="/img/iTBI.png"
        />
        <div style="margin-top: 50px" class="col">
          <h1 id="head-name" class="text-center">iTBI Medical Portal</h1>
          <hr />
        </div>
      </div>
      <!-- Nav tabs -->
      <h2 id="title"><a href="/landing.html"><</a></h2>
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a
            class="nav-link active"
            id="contact-tab"
            data-toggle="tab"
            href="#contact"
            role="tab"
            aria-controls="contact"
            aria-selected="true"
            >Caregiver Contact</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            id="team-tab"
            data-toggle="tab"
            href="#team"
            role="tab"
            aria-controls="team"
            aria-selected="false"
            >My Team</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            id="info-tab"
            data-toggle="tab"
            href="#info"
            role="tab"
            aria-controls="info"
            aria-selected="false"
            >Patient/TBI Info</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            id="docs-tab"
            data-toggle="tab"
            href="#docs"
            role="tab"
            aria-controls="docs"
            aria-selected="false"
            >Assign Documents</a
          >
        </li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content">
        <div
          class="tab-pane active"
          id="contact"
          role="tabpanel"
          aria-labelledby="contact-tab"
        >
          <h4 id="caregiver" style="margin-top:10px;"></h4>
          <div class="col-sm-6">
            <table
              style="padding: 2px;"
              class="text-center table-hover table-bordered"
            >
              <tr>
                <th>Home Address:</th>
                <td id="address"></td>
              </tr>
              <tr>
                <th>Phone Number:</th>
                <td id="phone"></td>
              </tr>
              <tr>
                <th>Email Address:</th>
                <td id="email"></td>
              </tr>
            </table>
          </div>
        </div>
        <div
          class="tab-pane"
          id="team"
          role="tabpanel"
          aria-labelledby="team-tab"
        >
          <div class="row" style="padding-top: 10px;">
            <div class="col-md-2">
              <img
                class="img-fluid"
                style="border-radius: 50px;"
                src="img/garamond.jpg"
              />
            </div>
            <div class="col-md-10">
              <h4 style="margin-top: 50px; font-size: 4vh;">Dr. Garamond</h4>
              <h6 style="font-size: 2.5vh; margin-bottom: 0px; color: green;">
                United Medical, LLC.
              </h6>
            </div>
            <div class="col-md-12"><hr /></div>
            <div class="col-md-2">
              <img
                class="img-fluid"
                style="border-radius: 50px;"
                src="img/arial.jpg"
              />
            </div>
            <div class="col-md-10">
              <h4 style="margin-top: 100px; font-size: 4vh;">Dr. Arial</h4>
              <h6 style="font-size: 2.5vh; margin-bottom: 0px; color: green;">
                Pioneer Rehabilitation
              </h6>
            </div>
          </div>
        </div>
        <div
          class="tab-pane"
          id="info"
          role="tabpanel"
          aria-labelledby="info-tab"
        >
          <div class="row">
            <div class="col-md-6">
              <table
                class="table table-responsive table-hover"
                style="margin-bottom: 25px; margin-top: 25px"
              >
                <tr>
                  <th style="padding-right: 10px">Height:</th>
                  <td id="height"></td>
                </tr>
                <tr>
                  <th style="padding-right: 10px">Weight:</th>
                  <td id="weight"></td>
                </tr>
                <tr>
                  <th style="padding-right: 10px">Age:</th>
                  <td id="age"></td>
                </tr>
                <tr>
                  <th style="padding-right: 10px">Patient ID:</th>
                  <td id="id"></td>
                </tr>
              </table>

              <h5>Patient Summary</h5>
              <hr />
              <p id="summary"></p>
            </div>
          </div>
        </div>
        <div
          class="tab-pane"
          id="docs"
          role="tabpanel"
          aria-labelledby="docs-tab"
        >
          <div class="row">
            <div class="col-auto">
              <h4 style="margin-top: 18px;">Subject:&nbsp;</h4>
            </div>
            <div style="margin-left: -25px;" class="col-auto">
              <form
                id="file-form"
                action=""
                onsubmit="uploadFile();return false;"
              >
                <input id="file-form-subject" />
                <input id="input-file" type="file" multiple />
                <input type="submit" />
              </form>
            </div>
            <div class="col-auto"><div id="loading"></div></div>
          </div>
          <h3 id="success"></h3>
        </div>
      </div>
    </div>
    <script src="/js/patient.js"></script>
    <script>
      window.onload = async function() {
        var nameParam = new URLSearchParams(window.location.search);
        // Patient Name
        var patientName = nameParam.get("name");

        fetch("http://18.216.125.191:5000/user/" + patientName + "/data", {
          mode: "cors"
        })
          .then(function(response) {
            return response.json();
          })
          .then(function(json) {
            console.log(json);
            var title = document.getElementById("title");
            var titleText = document.createTextNode(" " + json.name);
            title.appendChild(titleText);

            // Caregiver Contact
            var caregiver = document.getElementById("caregiver");
            var cgText = document.createTextNode(json.caregiver.name);
            caregiver.append(cgText);

            var cgAddress = document.getElementById("address");
            var address = document.createTextNode(json.caregiver.address);
            cgAddress.append(address);

            document
              .getElementById("phone")
              .append(document.createTextNode(json.caregiver.phone));

            var cgEmail = document.getElementById("email");
            var email = document.createTextNode(json.caregiver.email);
            cgEmail.append(email);

            // Patient/TBI info
            var height = document.getElementById("height");
            var heightStr = document.createTextNode(json.info.height);
            height.append(heightStr);

            var weight = document.getElementById("weight");
            var weightStr = document.createTextNode(json.info.weight);
            weight.append(weightStr);

            var age = document.getElementById("age");
            var ageStr = document.createTextNode(json.info.age);
            age.append(ageStr);

            var id = document.getElementById("id");
            var idStr = document.createTextNode(json.info.id);
            id.append(idStr);

            var summary = document.getElementById("summary");
            var summaryStr = document.createTextNode(json.info.summary);
            summary.append(summaryStr);
          });
      };
    </script>
  </body>
</html>
